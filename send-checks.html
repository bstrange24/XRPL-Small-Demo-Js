<!DOCTYPE html>
<html lang="en">
     <head>
          <title>Send Checks</title>
          <link href='https://fonts.googleapis.com/css?family=Work Sans' rel='stylesheet'>
          <link href="modular-tutorials.css" rel="stylesheet">
          <script src='https://unpkg.com/xrpl@4.1.0/build/xrpl-latest.js'></script>
          <link rel="icon" href="data:;base64,iVBORw0KGgo="> <!-- Suppress favicon 404 -->
          <script type="module" src="./main.js"></script>
          <script type="module" src="./send-checks.js"></script>
          <script type="module" src="./local-storage.js"></script>
     </head>

     <body>
     <div id="navbar-container"></div>
     <form id="theForm">
          <div id="wallet-issuer-input-container"></div>
          <p></p>
          <fieldset>
               <legend style="color: white;">Transaction Information</legend>
               <table style="float: left;">
                    <th>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Name of the currently selected account.">
                                        <label for="accountNameField">Name</label>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="accountNameField" size="40" readonly></input>
                                   <input type="radio" id="account1" name="accounts" value="account1">
                                   <label for="account1">Account 1</label>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Address of the currently selected account.">
                                        <label for="accountAddressField">Address</label>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="accountAddressField" size="40" readonly></input>
                                   <input type="radio" id="account2" name="accounts" value="account2">
                                   <label for="account2">Account 2</label>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Seed of the currently selected account.">
                                        <label for="accountSeedField">Seed</label>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="accountSeedField" size="40" readonly></input>
                                   <input type="radio" id="accountIssuer" name="accounts" value="accountIssuer">
                                   <label for="accountIssuer">Issuer</label>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="XRP balance for the currently selected account.">
                                        <label for="xrpBalanceField">Balance</label>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="xrpBalanceField" size="40" readonly></input>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Currency code for the check.">
                                        <lable for="currencyField">Currency Code</lable>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="currencyField" size="40"></input>
                                   <br>
                              </td> 
                         </tr>
                    </th>
               </table>

               <table style="float: left;">
                    <th>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Issuing account for the currency.">
                                        <lable for="issuerField">Issuer</lable>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="issuerField" size="40"></input>
                                   <br>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Amount of XRP to send.">
                                        <label for="amountField">Amount</label>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="amountField" size="40"></input>
                                   <br>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Destination account address where XRP is sent.">
                                   <lable for="destinationField">Destination</lable>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="destinationField" size="40"></input>
                                   <br>
                              </td>
                         </tr>
                         <tr style="vertical-align: top;">
                              <td style="text-align: right;">
                                   <span class="tooltip" tooltip-data="Check ID.">
                                   <lable for="checkIdField">Check ID / Ledger Index</lable>
                                   </span>
                              </td>
                              <td>
                                   <input type="text" id="checkIdField" size="40"></input>
                                   <br>
                              </td>
                         </tr>
                         </th>
                    </th>
               </table>

               <table>
                    <th>
                         <tr>
                              <td>
                                   <button type="button" onClick="sendCheck()">Send Check</button>
                                   <button type="button" onClick="cashCheck()">Cash Check</button>
                                   <button type="button" onClick="getChecks()">Get Checks</button>
                                   <button type="button" onClick="cancelCheck()">Cancel Check</button>
                                   <button type="button" onClick="gatherAccountInfo()">Gather Account Info</button>
                                   <button type="button" onClick="distributeAccountInfo()">Distribute Account Info</button>
                              </td>
                         </tr>
                         <tr>
                              <td colspan="2">
                                   <p style="text-align: left;">
                                        <textarea id="resultField" cols="200" rows="20"></textarea>
                                   </p>
                              </td>
                         </tr>
                    </th>
               </table>
          </fieldset>
     </form>
     
     </body>

     <script>
          const radioButtons = document.querySelectorAll('input[type="radio"]');
          radioButtons.forEach(radio => {
               radio.addEventListener('change', function () {
                    if (this.value === 'account1') {
                         populateFieldSendCurrency1()
                    } else if (this.value === 'account2') {
                         populateFieldSendCurrency2()
                    } else if (this.value === 'accountIssuer') {
                         populateFieldSendCurrency3()
                    }
               });
          });

          // fetch('navbar.html')
          //      .then(res => res.text())
          //      .then(html => {
          //           document.getElementById('navbar-container').innerHTML = html;
          //      });

          fetch('wallet-issuer-input.html')
               .then(res => res.text())
               .then(html => {
                    document.getElementById('wallet-issuer-input-container').innerHTML = html;

                    function hideAllGenerateNewWalletButtons() {
                         const generateButtons = document.querySelectorAll('[id^="generateNewWallet_"]');
                         generateButtons.forEach(button => {
                              button.style.display = 'none';
                         });
                         const generateMnemonicButtons = document.querySelectorAll('[id^="generateNewWalletMnemonic_"]');
                         generateMnemonicButtons.forEach(button => {
                              button.style.display = 'none';
                         });
                         const generateNewWalletSecretButtons = document.querySelectorAll('[id^="generateNewWalletSecret_"]');
                         generateNewWalletSecretButtons.forEach(button => {
                              button.style.display = 'none';
                         });
                    }

                    function showAllGenerateNewWalletButtons() {
                         const generateButtons = document.querySelectorAll('[id^="generateNewWallet_"]');
                         generateButtons.forEach(button => {
                              button.style.display = 'inline-block';
                         });
                         const generateMnemonicButtons = document.querySelectorAll('[id^="generateNewWalletMnemonic_"]');
                         generateMnemonicButtons.forEach(button => {
                              button.style.display = 'inline-block';
                         });
                         const generateNewWalletSecretButtons = document.querySelectorAll('[id^="generateNewWalletSecret_"]');
                         generateNewWalletSecretButtons.forEach(button => {
                              button.style.display = 'inline-block';
                         });
                    }

                    function hideAllDeriveWalletButtons() {
                         const derivederiveWalletSeedButtons = document.querySelectorAll('[id^="deriveWalletSeed_"]');
                         derivederiveWalletSeedButtons.forEach(button => {
                              button.style.display = 'none';
                         });
                         const deriveWalletMnemonicButtons = document.querySelectorAll('[id^="deriveWalletMnemonic_"]');
                         deriveWalletMnemonicButtons.forEach(button => {
                              button.style.display = 'none';
                         });
                         const deriveWalletSecretButtons = document.querySelectorAll('[id^="deriveWalletSecret_"]');
                         deriveWalletSecretButtons.forEach(button => {
                              button.style.display = 'none';
                         });
                    }

                    function showAllDeriveWalletButtons() {
                         const derivederiveWalletSeedButtons = document.querySelectorAll('[id^="deriveWalletSeed_"]');
                         derivederiveWalletSeedButtons.forEach(button => {
                              button.style.display = 'inline-block';
                         });
                         const deriveWalletMnemonicButtons = document.querySelectorAll('[id^="deriveWalletMnemonic_"]');
                         deriveWalletMnemonicButtons.forEach(button => {
                              button.style.display = 'inline-block';
                         });
                         const deriveWalletSecretButtons = document.querySelectorAll('[id^="deriveWalletSecret_"]');
                         deriveWalletSecretButtons.forEach(button => {
                              button.style.display = 'inline-block';
                         });
                    }

                    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
                    let pageLoad = "Y";
                    checkboxes.forEach(checkbox => {
                         checkbox.addEventListener('change', function () {
                         pageLoad = "N";
                         if (this.checked) {
                              // Checkbox was checked
                              if (this.value === 'Y') {
                                   // Hide derive wallet buttons
                                   hideAllDeriveWalletButtons();
                                   showAllGenerateNewWalletButtons();
                              } else if (this.value === 'N') {
                                   // Hide create wallet buttons
                                   hideAllGenerateNewWalletButtons();
                                   showAllDeriveWalletButtons();
                              }
                         } else {
                              // Checkbox was unchecked
                              console.log(`${this.value} was unchecked`);
                              hideAllGenerateNewWalletButtons();
                              showAllDeriveWalletButtons();
                              // Optionally handle unchecking
                         }
                         });
                    });

                    if (pageLoad === 'Y') {
                         for (const checkbox of checkboxes) {
                         const isChecked = checkbox.checked; // true if checked, false if not
                         const checkboxValue = checkbox.value; // e.g., "account1" or "account2"
                         console.log(`Checkbox for ${checkboxValue}: ${isChecked ? 'Checked' : 'Not Checked'}`);

                         // Optionally, perform actions based on the checked state
                         if (isChecked) {
                              if (checkboxValue === 'Y') {
                                   hideAllDeriveWalletButtons();
                              } else if (checkboxValue === 'N') {
                                   console.log('Account 2 checkbox is checked, calling populate2()');
                                   populateFieldSendCurrency2();
                              }
                         }
                         }
                    }
               })
               .catch(error => {
                    console.error('Error loading wallet-issuer-input.html:', error);
               });
     </script>
</html>